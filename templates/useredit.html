{% extends "base.html" %}

{% block title %}Registration{% endblock title %}

{% block navbar %}
	<!--h4 class="pull-left">Registration</h4-->
{% endblock navbar %}
{% block body %}
	<div class="container">
		<div class="row">
			<div class="col-lg-12 view bg_white">
				<form class="form-horizontal" method="post">
					{% csrf_token %}
					<div class="form-group">
						<label class="col-lg-2 control-label" for="cover">Cover</label>
						<div class="col-lg-10">
							<input class="pull-left" type="url" id="cover" name="cover" placeholder="Cover image url" value="{{ user.userprofile.cover }}" />
							<div class="text-error">{{ form.cover.errors }}</div>
						</div>
					</div>
					<div class="form-group">
						<label class="col-lg-2 control-label" for="avatar">Avatar</label>
						<div class="col-lg-10">
							<input class="pull-left" type="url" id="avatar" name="avatar" placeholder="Avatar image url" value="{{ user.userprofile.avatar }}" />
							<div class="text-error">{{ form.avatar.errors }}</div>
						</div>
					</div>
					<div class="form-group">
						<label class="col-lg-2 control-label" for="first_name">First name</label>
						<div class="col-lg-10">
							<input class="pull-left" type="text" id="first_name" name="first_name" placeholder="First Name" value="{{ user.first_name }}" required  maxlength="255" />
							<div class="text-error">{{ form.firstname.errors }}</div>
						</div>
					</div>
					<div class="form-group">
						<label class="col-lg-2 control-label" for="last_name">Last name</label>
						<div class="col-lg-10">
							<input class="pull-left" type="text" id="last_name" name="last_name" placeholder="Last Name" value="{{ user.last_name }}" required  maxlength="255" />
							<div class="text-error">{{ form.lastname.errors }}</div>
						</div>
					</div>

					{% if not user.userprofile.facebookUser%}
						<div class="form-group">
							<label class="col-lg-2 control-label" for="old_password">Old Password</label>
							<div class="col-lg-10">
								<input class="pull-left" type="password" id="old_password" name="old_password" placeholder="Password" required />
								<div class="text-error">{{ form.old_password.errors }}</div>
							</div>
						</div>
						<div class="form-group">
							<label class="col-lg-2 control-label" for="id_changepassword">Update password</label>
							<div class="col-lg-10">
								<!-- {{ form.changepassword }} -->
								<div class="checkbox">
									<label>
										<input type="checkbox" name="changepassword" id="id_changepassword">
									</label>
								</div>
							</div>
						</div>
						<div class="form-group">
							<label class="col-lg-2 control-label" for="new_password1">New password</label>
							<div class="col-lg-10">
								<input class="pull-left" type="password" id="new_password1" name="new_password1" placeholder="New Password" disabled />
							</div>
						</div>
						<div class="form-group">
							<label class="col-lg-2 control-label" for="new_password2">Confirm password</label>
							<div class="col-lg-10">
								<input class="pull-left" type="password" id="new_password2" name="new_password2" placeholder="Confirm New Password" oninput="confirm_pwd(this);"  disabled />
								<div class="text-error">{{ form.new_password2.errors }}</div>
							</div>
						</div>
					{% endif %}
					<div class="form-group">
						<label class="col-lg-2 control-label"></label>
						<div class="col-lg-10">
							<button type="submit" class="btn btn-primary">Submit</button>
							<a href="{% url home %}" class="btn btn-default">Cancel</a>
						</div>
					</div>
					{% if form.non_field_errors %}
						<div class="alert alert-error">
							{{ form.non_field_errors }}
						</div>
					{% endif %}
				</form>
			</div>
		</div>
	</div>
{% endblock body%}

{% block bottom_javascript%}
	{{ block.super }}
	<script type="text/javascript">
		//Function to validate if both the passwords match
		function confirm_pwd(input) {
			if (input.value != document.getElementById('new_password1').value) {
				input.setCustomValidity('The two passwords must match.');
			} else {
				// input is valid -- reset the error message
				input.setCustomValidity('');
			}
		}

		$(document).ready(function(){
			if($('#id_changepassword').is(':checked')){
				$('#new_password1, #new_password2').attr('disabled',false);
			}else{
				$('#new_password1, #new_password2').attr('disabled',true).val('');
			}

			$('#id_changepassword').click(function(){
				var is_checked = $(this).is(':checked');
				if(is_checked){
					$('#new_password1, #new_password2').attr('disabled',false);
				}else{
					$('#new_password1, #new_password2').attr('disabled',true).val('');
				}
			});
		});
	</script>

{% endblock bottom_javascript%}
